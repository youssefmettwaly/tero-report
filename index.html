<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>tero hack report - Admin Panel</title>
  <style>
    :root{--p:#e74c3c;--s:#27ae60;--d:#c0392b;--bg:#1a1a1a;--card:#2d2d2d;--text:#f0f0f0;}
    *{margin:0;padding:0;box-sizing:border-box;font-family:Segoe UI,Tahoma,sans-serif;}
    body{background:var(--bg);color:var(--text);min-height:100vh;}
    
    /* === Top Bar === */
    .topbar{
      background:var(--p);padding:12px 20px;display:flex;justify-content:space-between;align-items:center;
      position:sticky;top:0;z-index:1000;box-shadow:0 2px 10px rgba(0,0,0,0.3);
    }
    .site-name{font-size:1.4rem;font-weight:bold;color:white;}
    .auth-btn{padding:8px 16px;border:none;border-radius:8px;cursor:pointer;font-weight:600;
      background:white;color:var(--p);transition:0.3s;}
    .auth-btn:hover{transform:scale(1.05);background:#f0f0f0;}

    /* === Login Page === */
    .login-container{
      display:flex;justify-content:center;align-items:center;min-height:90vh;
    }
    .login-box{
      background:var(--card);padding:40px;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,0.5);
      width:100%;max-width:420px;text-align:center;
    }
    .login-box h2{color:var(--p);margin-bottom:20px;font-size:1.8rem;}
    input{width:100%;padding:14px;margin:12px 0;border:none;border-radius:10px;
      background:#3a3a3a;color:white;font-size:1rem;}
    input::placeholder{color:#aaa;}
    .login-btn{width:100%;padding:14px;background:var(--p);color:white;border:none;
      border-radius:10px;font-weight:bold;cursor:pointer;margin-top:10px;transition:0.3s;}
    .login-btn:hover{background:#c0392b;}
    .error{color:#ff6b6b;margin-top:10px;font-size:0.9rem;}

    /* === Dashboard === */
    .container{max-width:1100px;margin:20px auto;padding:0 20px;}
    .card{background:var(--card);border-radius:12px;overflow:hidden;
      box-shadow:0 5px 20px rgba(0,0,0,0.4);margin-bottom:25px;}
    .card-header{background:var(--p);color:white;padding:16px;text-align:center;font-size:1.2rem;}
    .card-body{padding:25px;}
    .report-item{
      background:#3a3a3a;padding:16px;border-radius:10px;margin-bottom:12px;
      display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;
      transition:0.2s;
    }
    .report-item:hover{transform:translateY(-2px);box-shadow:0 5px 15px rgba(0,0,0,0.3);}
    .report-name{font-weight:600;font-size:1.1rem;}
    .report-meta{font-size:0.85rem;color:#aaa;margin-top:4px;}
    .btn-sm{padding:6px 12px;border:none;border-radius:8px;cursor:pointer;font-size:0.85rem;
      font-weight:600;margin:2px;}
    .btn-view{background:var(--s);color:white;}
    .btn-delete{background:var(--d);color:white;}
    .btn-sm:hover{opacity:0.9;}

    /* === Modal === */
    .modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;
      background:rgba(0,0,0,0.8);justify-content:center;align-items:center;z-index:2000;}
    .modal-content{background:var(--card);padding:25px;border-radius:16px;
      max-width:900px;width:90%;max-height:85vh;overflow:auto;position:relative;}
    .close{float:right;font-size:28px;cursor:pointer;color:#aaa;}
    .close:hover{color:white;}
    pre{white-space:pre-wrap;font-family:monospace;background:#1e1e1e;padding:15px;
      border-radius:8px;color:#0f0;margin:15px 0;max-height:60vh;overflow:auto;}
    .download-btn{margin-top:15px;background:var(--s);color:white;padding:10px 20px;
      border:none;border-radius:8px;cursor:pointer;font-weight:bold;}

    .hidden{display:none !important;}
    .footer{text-align:center;padding:30px;color:#666;font-size:0.9rem;}
  </style>
</head>
<body>

<!-- === Top Bar (Always Visible) === -->
<div class="topbar">
  <div class="site-name">tero hack report</div>
  <button id="authButton" class="auth-btn" onclick="toggleAuth()">Login</button>
</div>

<!-- === Login Page === -->
<div id="loginPage" class="login-container">
  <div class="login-box">
    <h2>IT Admin Login</h2>
    <input type="text" id="username" placeholder="Username" value="">
    <input type="password" id="password" placeholder="Password" value="">
    <button class="login-btn" onclick="login()">Login to Dashboard</button>
    <p id="errorMsg" class="error"></p>
  </div>
</div>

<!-- === Dashboard (Hidden Initially) === -->
<div id="dashboard" class="container hidden">
  <div class="card">
    <div class="card-header">Uploaded Hack Reports</div>
    <div class="card-body">
      <div id="reportsList">Loading reports...</div>
    </div>
  </div>
  <div class="footer">© 2025 tero hack report • Internal IT Use Only</div>
</div>

<!-- === Modal === -->
<div id="modal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">×</span>
    <h3 id="modalTitle" style="color:var(--p);margin-bottom:15px;"></h3>
    <pre id="modalContent"></pre>
    <button class="download-btn" onclick="downloadReport()">Download Report (.txt)</button>
  </div>
</div>

<script>
const USER = "meto";
const PASS = "511970";
let reports = [];

// === Toggle Auth Button ===
function toggleAuth() {
  const isLoggedIn = !document.getElementById('dashboard').classList.contains('hidden');
  if (isLoggedIn) {
    logout();
  } else {
    document.getElementById('loginPage').style.display = 'flex';
    document.getElementById('dashboard').classList.add('hidden');
    document.getElementById('authButton').textContent = 'Login';
  }
}

// === Login ===
function login() {
  const u = document.getElementById('username').value.trim();
  const p = document.getElementById('password').value;
  const err = document.getElementById('errorMsg');

  if (u === USER && p === PASS) {
    document.getElementById('loginPage').style.display = 'none';
    document.getElementById('dashboard').classList.remove('hidden');
    document.getElementById('authButton').textContent = 'Logout';
    loadReports();
  } else {
    err.textContent = "Invalid credentials!";
  }
}

// === Logout ===
function logout() {
  document.getElementById('dashboard').classList.add('hidden');
  document.getElementById('loginPage').style.display = 'flex';
  document.getElementById('authButton').textContent = 'Login';
  document.getElementById('username').value = 'meto';
  document.getElementById('password').value = '511970';
  document.getElementById('errorMsg').textContent = '';
}

// === Load Reports ===
function loadReports() {
  reports = JSON.parse(localStorage.getItem('security_reports') || '[]');
  const list = document.getElementById('reportsList');
  if (reports.length === 0) {
    list.innerHTML = '<p style="text-align:center;color:#aaa;">No hack reports uploaded yet</p>';
    return;
  }
  list.innerHTML = reports.map((r, i) => `
    <div class="report-item">
      <div>
        <div class="report-name">Hack Report #${reports.length - i}</div>
        <div class="report-meta">${new Date(r.timestamp).toLocaleString('en-EG')}</div>
      </div>
      <div>
        <button class="btn-sm btn-view" onclick="view('${r.id}')">View</button>
        <button class="btn-sm btn-delete" onclick="del('${r.id}')">Delete</button>
      </div>
    </div>
  `).join('');
}

// === View, Download, Delete ===
function view(id) {
  const r = reports.find(x => x.id === id);
  document.getElementById('modalTitle').textContent = `Hack Report #${reports.indexOf(r) + 1}`;
  document.getElementById('modalContent').textContent = r.content;
  document.getElementById('modal').style.display = 'flex';
  window.current = r;
}
function downloadReport() {
  const a = document.createElement('a');
  a.href = URL.createObjectURL(new Blob([window.current.content], {type:'text/plain'}));
  a.download = `hack_report_${new Date(window.current.timestamp).toISOString().slice(0,19).replace(/:/g,'-')}.txt`;
  a.click();
}
function del(id) {
  if (confirm('Delete this hack report permanently?')) {
    reports = reports.filter(x => x.id !== id);
    localStorage.setItem('security_reports', JSON.stringify(reports));
    loadReports();
  }
}
function closeModal() {
  document.getElementById('modal').style.display = 'none';
}

// === Auto Refresh + New Report Listener ===
setInterval(() => {
  if (!document.getElementById('dashboard').classList.contains('hidden')) loadReports();
}, 5000);

if (window.BroadcastChannel) {
  new BroadcastChannel('report_channel').onmessage = () => {
    if (!document.getElementById('dashboard').classList.contains('hidden')) loadReports();
  };
}

// === On Load: Show Login ===
window.onload = () => {
  document.getElementById('dashboard').classList.add('hidden');
  document.getElementById('loginPage').style.display = 'flex';
  document.getElementById('authButton').textContent = 'Login';
};
</script>
</body>
</html>

